2025-03-06 14:52:08,106 - __main__ - INFO - Starting experiment with timestamp: 20250306_145208
2025-03-06 14:52:08,106 - __main__ - INFO - Input file: /home/dsg/VORTEX_FINAL/PRODUCTION/DATA/raw/input_data.xlsx
2025-03-06 14:52:08,107 - __main__ - INFO - Output directory: outputs/experiment_20250306_145208
2025-03-06 14:52:08,107 - __main__ - INFO - Starting data preprocessing...
2025-03-06 14:52:10,772 - src.preprocessing.data_processor - INFO - Data successfully uploaded: (1816, 67)
2025-03-06 14:52:10,781 - src.preprocessing.data_processor - INFO - Found 14 duplicate IDs
2025-03-06 14:52:10,782 - src.preprocessing.data_processor - INFO - Unique records after deleting duplicates: 1802
2025-03-06 14:52:10,788 - src.preprocessing.data_processor - INFO - Deleting 6 classes with less than 10 cases
2025-03-06 14:52:10,794 - src.preprocessing.data_processor - INFO - Data split - Training: (1600, 46), Validation: (178, 46)
2025-03-06 14:52:10,899 - src.preprocessing.data_processor - INFO - Balanced data - Final shape: (2256, 45)
2025-03-06 14:52:13,085 - src.preprocessing.data_processor - INFO - Training data saved in outputs/experiment_20250306_145208/data/processed/training_data_20250306_145208.xlsx
2025-03-06 14:52:13,246 - src.preprocessing.data_processor - INFO - Validation data saved in outputs/experiment_20250306_145208/data/processed/validation_data_20250306_145208.xlsx
2025-03-06 14:52:13,247 - __main__ - INFO - Starting model training...
2025-03-06 14:52:13,247 - src.training.model_trainer - INFO - Configuring training experiment...
2025-03-06 14:52:16,657 - src.training.model_trainer - INFO - Experiment configured successfully
2025-03-06 14:52:16,658 - src.training.model_trainer - INFO - Starting model training...
2025-03-06 14:52:29,778 - src.training.model_trainer - INFO - Optimizing hyperparameters...
2025-03-06 14:53:21,274 - src.training.model_trainer - INFO - Saved tuned model directly to outputs/experiment_20250306_145208/models/tuned_model_direct.pkl
2025-03-06 14:53:21,275 - src.training.model_trainer - INFO - Saving tuned model before calibration...
2025-03-06 14:53:21,563 - src.training.model_trainer - INFO - Calibrating model probabilities...
2025-03-06 14:54:02,800 - src.training.model_trainer - INFO - Saved final model directly to outputs/experiment_20250306_145208/models/final_model_direct.pkl
2025-03-06 14:54:02,800 - src.training.model_trainer - INFO - Training completed successfully
2025-03-06 14:54:02,801 - src.training.model_trainer - INFO - Evaluating model on validation data...
2025-03-06 14:54:04,177 - src.training.model_trainer - INFO - Evaluation completed
2025-03-06 14:54:04,177 - __main__ - INFO - Starting feature importance analysis...
2025-03-06 14:54:04,179 - __main__ - INFO - Retrieving tuned model for feature importance analysis...
2025-03-06 14:54:04,179 - __main__ - INFO - Running feature importance analysis...
2025-03-06 14:54:04,179 - src.analysis.feature_importance_analyzer - INFO - Starting feature importance analysis...
2025-03-06 14:54:04,179 - src.analysis.feature_importance_analyzer - INFO - Data shape: X=(2256, 44), y=(2256,)
2025-03-06 14:54:04,179 - src.analysis.feature_importance_analyzer - INFO - Output directory: outputs/experiment_20250306_145208
2025-03-06 14:54:04,179 - src.analysis.feature_importance_analyzer - INFO - Starting RFECV analysis...
2025-03-06 14:54:04,179 - src.analysis.feature_importance_analyzer - INFO - Running RFECV with 10 iterations...
2025-03-06 14:54:04,239 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 1/10
2025-03-06 14:56:36,364 - src.analysis.feature_importance_analyzer - INFO - Iteration 1 completed: selected 42 features
2025-03-06 14:56:36,365 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 2/10
2025-03-06 14:59:21,094 - src.analysis.feature_importance_analyzer - INFO - Iteration 2 completed: selected 31 features
2025-03-06 14:59:21,095 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 3/10
2025-03-06 15:01:53,919 - src.analysis.feature_importance_analyzer - INFO - Iteration 3 completed: selected 42 features
2025-03-06 15:01:53,919 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 4/10
2025-03-06 15:04:52,118 - src.analysis.feature_importance_analyzer - INFO - Iteration 4 completed: selected 28 features
2025-03-06 15:04:52,118 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 5/10
2025-03-06 15:07:43,867 - src.analysis.feature_importance_analyzer - INFO - Iteration 5 completed: selected 25 features
2025-03-06 15:07:43,867 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 6/10
2025-03-06 15:10:21,933 - src.analysis.feature_importance_analyzer - INFO - Iteration 6 completed: selected 38 features
2025-03-06 15:10:21,933 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 7/10
2025-03-06 15:13:08,315 - src.analysis.feature_importance_analyzer - INFO - Iteration 7 completed: selected 39 features
2025-03-06 15:13:08,318 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 8/10
2025-03-06 15:15:48,803 - src.analysis.feature_importance_analyzer - INFO - Iteration 8 completed: selected 35 features
2025-03-06 15:15:48,803 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 9/10
2025-03-06 15:18:40,776 - src.analysis.feature_importance_analyzer - INFO - Iteration 9 completed: selected 24 features
2025-03-06 15:18:40,777 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 10/10
2025-03-06 15:21:25,317 - src.analysis.feature_importance_analyzer - INFO - Iteration 10 completed: selected 42 features
2025-03-06 15:21:25,347 - src.analysis.feature_importance_analyzer - INFO - Creating RFECV plot...
2025-03-06 15:21:26,311 - src.analysis.feature_importance_analyzer - INFO - RFECV plot saved successfully
2025-03-06 15:21:26,312 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance plot...
2025-03-06 15:21:26,319 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance dot plot based on importance values...
2025-03-06 15:21:27,349 - src.analysis.feature_importance_analyzer - INFO - Feature importance plot saved successfully
2025-03-06 15:21:27,349 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-06 15:21:27,351 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-06 15:21:39,883 - src.analysis.feature_importance_analyzer - INFO - SHAP analysis completed successfully
2025-03-06 15:21:39,884 - src.analysis.feature_importance_analyzer - INFO - Feature importance analysis completed successfully
2025-03-06 15:21:39,884 - __main__ - INFO - Starting specific models training...
2025-03-06 15:21:39,885 - src.training.specific_models_trainer_pycaret - INFO - Features pool set with 4 configurations
2025-03-06 15:21:39,886 - src.training.specific_models_trainer_pycaret - INFO - Starting training of all specific models...
2025-03-06 15:21:39,886 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-06 15:21:39,886 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_Destilled
2025-03-06 15:21:39,886 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-06 15:21:39,914 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 15)
2025-03-06 15:21:39,924 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-06 15:21:39,924 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 15)
2025-03-06 15:21:39,924 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_Destilled...
2025-03-06 15:21:39,925 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-06 15:21:41,517 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-06 15:21:52,019 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_Destilled...
2025-03-06 15:22:34,003 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_Destilled...
2025-03-06 15:23:02,898 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_Destilled...
2025-03-06 15:23:08,188 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250306_145208/models/rf_Destilled
2025-03-06 15:23:08,189 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_Destilled on validation data...
2025-03-06 15:23:09,272 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250306_145208/tables/rf_Destilled_classification_report.csv
2025-03-06 15:23:09,617 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250306_145208/plots/rf_Destilled_confusion_matrix.png
2025-03-06 15:23:09,623 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250306_145208/tables/rf_Destilled_predictions.csv
2025-03-06 15:23:09,624 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-06 15:23:09,624 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_French
2025-03-06 15:23:09,624 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-06 15:23:09,634 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 23)
2025-03-06 15:23:09,635 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-06 15:23:09,636 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 23)
2025-03-06 15:23:09,636 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_French...
2025-03-06 15:23:09,636 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-06 15:23:11,141 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-06 15:23:19,708 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_French...
2025-03-06 15:24:12,087 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_French...
2025-03-06 15:24:43,469 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_French...
2025-03-06 15:24:49,010 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250306_145208/models/rf_French
2025-03-06 15:24:49,010 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_French on validation data...
2025-03-06 15:24:49,983 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250306_145208/tables/rf_French_classification_report.csv
2025-03-06 15:24:50,322 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250306_145208/plots/rf_French_confusion_matrix.png
2025-03-06 15:24:50,332 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250306_145208/tables/rf_French_predictions.csv
2025-03-06 15:24:50,333 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-06 15:24:50,333 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_Quiruelas
2025-03-06 15:24:50,333 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-06 15:24:50,337 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 18)
2025-03-06 15:24:50,339 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-06 15:24:50,339 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 18)
2025-03-06 15:24:50,339 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_Quiruelas...
2025-03-06 15:24:50,339 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-06 15:24:51,490 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-06 15:24:59,063 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_Quiruelas...
2025-03-06 15:25:47,601 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_Quiruelas...
2025-03-06 15:26:19,458 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_Quiruelas...
2025-03-06 15:26:25,073 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250306_145208/models/rf_Quiruelas
2025-03-06 15:26:25,074 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_Quiruelas on validation data...
2025-03-06 15:26:26,089 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250306_145208/tables/rf_Quiruelas_classification_report.csv
2025-03-06 15:26:26,397 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250306_145208/plots/rf_Quiruelas_confusion_matrix.png
2025-03-06 15:26:26,405 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250306_145208/tables/rf_Quiruelas_predictions.csv
2025-03-06 15:26:26,405 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-06 15:26:26,405 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_VdH
2025-03-06 15:26:26,405 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-06 15:26:26,409 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 20)
2025-03-06 15:26:26,411 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-06 15:26:26,411 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 20)
2025-03-06 15:26:26,411 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_VdH...
2025-03-06 15:26:26,411 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-06 15:26:27,622 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-06 15:26:35,956 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_VdH...
2025-03-06 15:27:28,673 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_VdH...
2025-03-06 15:28:05,571 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_VdH...
2025-03-06 15:28:12,165 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250306_145208/models/rf_VdH
2025-03-06 15:28:12,165 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_VdH on validation data...
2025-03-06 15:28:13,132 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250306_145208/tables/rf_VdH_classification_report.csv
2025-03-06 15:28:13,423 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250306_145208/plots/rf_VdH_confusion_matrix.png
2025-03-06 15:28:13,429 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250306_145208/tables/rf_VdH_predictions.csv
2025-03-06 15:28:13,429 - src.training.specific_models_trainer_pycaret - INFO - 

================================================================================
2025-03-06 15:28:13,430 - src.training.specific_models_trainer_pycaret - INFO - MODEL PERFORMANCE SUMMARY
2025-03-06 15:28:13,430 - src.training.specific_models_trainer_pycaret - INFO - ================================================================================
2025-03-06 15:28:13,430 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_Destilled
2025-03-06 15:28:13,430 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9494
2025-03-06 15:28:13,431 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9478
2025-03-06 15:28:13,431 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9493
2025-03-06 15:28:13,432 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-06 15:28:13,432 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_French
2025-03-06 15:28:13,433 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9607
2025-03-06 15:28:13,433 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9583
2025-03-06 15:28:13,433 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9606
2025-03-06 15:28:13,433 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-06 15:28:13,434 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_Quiruelas
2025-03-06 15:28:13,435 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9494
2025-03-06 15:28:13,435 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9454
2025-03-06 15:28:13,436 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9495
2025-03-06 15:28:13,436 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-06 15:28:13,436 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_VdH
2025-03-06 15:28:13,437 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9101
2025-03-06 15:28:13,438 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9084
2025-03-06 15:28:13,438 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9098
2025-03-06 15:28:13,438 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-06 15:28:13,439 - src.training.specific_models_trainer_pycaret - INFO - 
Process completed successfully!
2025-03-06 15:28:13,440 - __main__ - INFO - 
Top 14 most important features:
2025-03-06 15:28:13,441 - __main__ - INFO - - Ca: 0.2120
2025-03-06 15:28:13,441 - __main__ - INFO - - As: 0.1201
2025-03-06 15:28:13,442 - __main__ - INFO - - Ba: 0.0702
2025-03-06 15:28:13,442 - __main__ - INFO - - V: 0.0689
2025-03-06 15:28:13,442 - __main__ - INFO - - Sr: 0.0659
2025-03-06 15:28:13,443 - __main__ - INFO - - Cr: 0.0483
2025-03-06 15:28:13,443 - __main__ - INFO - - Mo: 0.0443
2025-03-06 15:28:13,443 - __main__ - INFO - - Ta: 0.0440
2025-03-06 15:28:13,444 - __main__ - INFO - - Cu: 0.0346
2025-03-06 15:28:13,444 - __main__ - INFO - - K: 0.0329
2025-03-06 15:28:13,445 - __main__ - INFO - - Ti: 0.0290
2025-03-06 15:28:13,445 - __main__ - INFO - - Se: 0.0212
2025-03-06 15:28:13,446 - __main__ - INFO - - S: 0.0178
2025-03-06 15:28:13,446 - __main__ - INFO - - Cl: 0.0173
2025-03-06 15:28:13,450 - __main__ - INFO - Process completed successfully!
2025-03-06 15:28:13,450 - __main__ - INFO - Results saved in: outputs/experiment_20250306_145208
