2025-05-17 20:57:02,095 - __main__ - INFO - Starting experiment with timestamp: 20250517_205702
2025-05-17 20:57:02,095 - __main__ - INFO - Input file: DATA/raw/input_data.xlsx
2025-05-17 20:57:02,095 - __main__ - INFO - Output directory: my_experiments/experiment_20250517_205702
2025-05-17 20:57:02,096 - __main__ - INFO - Full analysis: Yes
2025-05-17 20:57:02,096 - __main__ - INFO - Starting data preprocessing...
2025-05-17 20:57:04,836 - src.preprocessing.data_processor - INFO - Data successfully uploaded: (1816, 67)
2025-05-17 20:57:04,846 - src.preprocessing.data_processor - INFO - Found 14 duplicate IDs
2025-05-17 20:57:04,847 - src.preprocessing.data_processor - INFO - Unique records after deleting duplicates: 1802
2025-05-17 20:57:04,849 - src.preprocessing.data_processor - INFO - Deleting 6 classes with less than 15 cases
2025-05-17 20:57:04,854 - src.preprocessing.data_processor - INFO - Data split - Training: (1422, 46), Validation: (356, 46)
2025-05-17 20:57:04,954 - src.preprocessing.data_processor - INFO - Balanced data - Final shape: (2031, 45)
2025-05-17 20:57:06,779 - src.preprocessing.data_processor - INFO - Training data saved in my_experiments/experiment_20250517_205702/data/processed/training_data_20250517_205702.xlsx
2025-05-17 20:57:07,240 - src.preprocessing.data_processor - INFO - Validation data saved in my_experiments/experiment_20250517_205702/data/processed/validation_data_20250517_205702.xlsx
2025-05-17 20:57:07,240 - __main__ - INFO - Starting model training...
2025-05-17 20:57:07,241 - src.training.model_trainer - INFO - Configuring training experiment...
2025-05-17 20:57:10,469 - src.training.model_trainer - INFO - Experiment configured successfully
2025-05-17 20:57:10,469 - src.training.model_trainer - INFO - Starting model training...
2025-05-17 20:57:25,482 - src.training.model_trainer - INFO - Optimizing hyperparameters...
2025-05-17 20:58:27,956 - src.training.model_trainer - INFO - Saved tuned model directly to my_experiments/experiment_20250517_205702/models/tuned_model_direct.pkl
2025-05-17 20:58:27,956 - src.training.model_trainer - INFO - Saving tuned model before calibration...
2025-05-17 20:58:28,312 - src.training.model_trainer - INFO - Calibrating model probabilities...
2025-05-17 20:59:09,367 - src.training.model_trainer - INFO - Saved final model directly to my_experiments/experiment_20250517_205702/models/final_model_direct.pkl
2025-05-17 20:59:09,367 - src.training.model_trainer - INFO - Training completed successfully
2025-05-17 20:59:09,367 - src.training.model_trainer - INFO - Evaluating model on validation data...
2025-05-17 20:59:10,763 - src.training.model_trainer - INFO - Evaluation completed
2025-05-17 20:59:10,763 - __main__ - INFO - Starting feature importance analysis...
2025-05-17 20:59:10,768 - __main__ - INFO - Retrieving tuned model for feature importance analysis...
2025-05-17 20:59:10,768 - __main__ - INFO - Running feature importance analysis...
2025-05-17 20:59:10,768 - src.analysis.feature_importance_analyzer - INFO - Starting feature importance analysis...
2025-05-17 20:59:10,768 - src.analysis.feature_importance_analyzer - INFO - Data shape: X=(2031, 44), y=(2031,)
2025-05-17 20:59:10,769 - src.analysis.feature_importance_analyzer - INFO - Output directory: my_experiments/experiment_20250517_205702
2025-05-17 20:59:10,769 - src.analysis.feature_importance_analyzer - INFO - Starting RFECV analysis...
2025-05-17 20:59:10,769 - src.analysis.feature_importance_analyzer - INFO - Running RFECV with 10 iterations...
2025-05-17 20:59:10,816 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 1/10
2025-05-17 21:02:14,602 - src.analysis.feature_importance_analyzer - INFO - Iteration 1 completed: selected 25 features
2025-05-17 21:02:14,604 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 2/10
2025-05-17 21:05:15,804 - src.analysis.feature_importance_analyzer - INFO - Iteration 2 completed: selected 37 features
2025-05-17 21:05:15,805 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 3/10
2025-05-17 21:08:15,285 - src.analysis.feature_importance_analyzer - INFO - Iteration 3 completed: selected 26 features
2025-05-17 21:08:15,285 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 4/10
2025-05-17 21:11:25,830 - src.analysis.feature_importance_analyzer - INFO - Iteration 4 completed: selected 21 features
2025-05-17 21:11:25,830 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 5/10
2025-05-17 21:14:06,744 - src.analysis.feature_importance_analyzer - INFO - Iteration 5 completed: selected 38 features
2025-05-17 21:14:06,745 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 6/10
2025-05-17 21:16:46,535 - src.analysis.feature_importance_analyzer - INFO - Iteration 6 completed: selected 34 features
2025-05-17 21:16:46,536 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 7/10
2025-05-17 21:19:15,504 - src.analysis.feature_importance_analyzer - INFO - Iteration 7 completed: selected 44 features
2025-05-17 21:19:15,504 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 8/10
2025-05-17 21:22:05,222 - src.analysis.feature_importance_analyzer - INFO - Iteration 8 completed: selected 22 features
2025-05-17 21:22:05,222 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 9/10
2025-05-17 21:24:52,968 - src.analysis.feature_importance_analyzer - INFO - Iteration 9 completed: selected 23 features
2025-05-17 21:24:52,969 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 10/10
2025-05-17 21:27:22,486 - src.analysis.feature_importance_analyzer - INFO - Iteration 10 completed: selected 40 features
2025-05-17 21:27:22,533 - src.analysis.feature_importance_analyzer - INFO - Creating RFECV plot...
2025-05-17 21:27:23,181 - src.analysis.feature_importance_analyzer - INFO - RFECV plot saved successfully
2025-05-17 21:27:23,182 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance plot...
2025-05-17 21:27:23,199 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance dot plot based on importance values...
2025-05-17 21:27:24,094 - src.analysis.feature_importance_analyzer - INFO - Feature importance plot saved successfully
2025-05-17 21:27:24,094 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-05-17 21:27:24,095 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-05-17 21:27:33,148 - src.analysis.feature_importance_analyzer - INFO - SHAP analysis completed successfully
2025-05-17 21:27:33,149 - src.analysis.feature_importance_analyzer - INFO - Feature importance analysis completed successfully
2025-05-17 21:27:33,151 - __main__ - INFO - Starting specific models training...
2025-05-17 21:27:33,152 - src.training.specific_models_trainer_pycaret - INFO - Features pool set with 4 configurations
2025-05-17 21:27:33,152 - src.training.specific_models_trainer_pycaret - INFO - Starting training of all specific models...
2025-05-17 21:27:33,152 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-05-17 21:27:33,152 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_Destilled
2025-05-17 21:27:33,152 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-05-17 21:27:33,162 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2031, 15)
2025-05-17 21:27:33,166 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    677
CT      677
PCM     677
Name: count, dtype: int64
2025-05-17 21:27:33,166 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (356, 15)
2025-05-17 21:27:33,166 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_Destilled...
2025-05-17 21:27:33,166 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-05-17 21:27:34,477 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-05-17 21:27:44,109 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_Destilled...
2025-05-17 21:28:27,615 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_Destilled...
2025-05-17 21:28:56,928 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_Destilled...
2025-05-17 21:29:02,764 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/models/rf_Destilled
2025-05-17 21:29:02,764 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_Destilled on validation data...
2025-05-17 21:29:03,716 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_Destilled_classification_report.csv
2025-05-17 21:29:04,046 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/plots/rf_Destilled_confusion_matrix.png
2025-05-17 21:29:04,058 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_Destilled_predictions.csv
2025-05-17 21:29:04,058 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-05-17 21:29:04,058 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_French
2025-05-17 21:29:04,058 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-05-17 21:29:04,061 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2031, 23)
2025-05-17 21:29:04,063 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    677
CT      677
PCM     677
Name: count, dtype: int64
2025-05-17 21:29:04,063 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (356, 23)
2025-05-17 21:29:04,063 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_French...
2025-05-17 21:29:04,063 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-05-17 21:29:05,425 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-05-17 21:29:13,451 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_French...
2025-05-17 21:30:04,665 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_French...
2025-05-17 21:30:37,801 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_French...
2025-05-17 21:30:43,697 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/models/rf_French
2025-05-17 21:30:43,697 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_French on validation data...
2025-05-17 21:30:44,732 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_French_classification_report.csv
2025-05-17 21:30:45,109 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/plots/rf_French_confusion_matrix.png
2025-05-17 21:30:45,118 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_French_predictions.csv
2025-05-17 21:30:45,118 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-05-17 21:30:45,118 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_Quiruelas
2025-05-17 21:30:45,118 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-05-17 21:30:45,121 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2031, 18)
2025-05-17 21:30:45,122 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    677
CT      677
PCM     677
Name: count, dtype: int64
2025-05-17 21:30:45,122 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (356, 18)
2025-05-17 21:30:45,122 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_Quiruelas...
2025-05-17 21:30:45,123 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-05-17 21:30:46,338 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-05-17 21:30:54,014 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_Quiruelas...
2025-05-17 21:31:44,628 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_Quiruelas...
2025-05-17 21:32:16,289 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_Quiruelas...
2025-05-17 21:32:21,768 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/models/rf_Quiruelas
2025-05-17 21:32:21,769 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_Quiruelas on validation data...
2025-05-17 21:32:22,793 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_Quiruelas_classification_report.csv
2025-05-17 21:32:23,104 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/plots/rf_Quiruelas_confusion_matrix.png
2025-05-17 21:32:23,111 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_Quiruelas_predictions.csv
2025-05-17 21:32:23,112 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-05-17 21:32:23,112 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_VdH
2025-05-17 21:32:23,112 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-05-17 21:32:23,114 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2031, 20)
2025-05-17 21:32:23,115 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    677
CT      677
PCM     677
Name: count, dtype: int64
2025-05-17 21:32:23,115 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (356, 20)
2025-05-17 21:32:23,115 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_VdH...
2025-05-17 21:32:23,115 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-05-17 21:32:24,308 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-05-17 21:32:32,320 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_VdH...
2025-05-17 21:33:23,479 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_VdH...
2025-05-17 21:33:57,290 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_VdH...
2025-05-17 21:34:02,771 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/models/rf_VdH
2025-05-17 21:34:02,771 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_VdH on validation data...
2025-05-17 21:34:03,695 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_VdH_classification_report.csv
2025-05-17 21:34:04,039 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/plots/rf_VdH_confusion_matrix.png
2025-05-17 21:34:04,052 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: /home/dsg/VORTEX_FINAL/VORTEX/my_experiments/experiment_20250517_205702/tables/rf_VdH_predictions.csv
2025-05-17 21:34:04,052 - src.training.specific_models_trainer_pycaret - INFO - 

================================================================================
2025-05-17 21:34:04,052 - src.training.specific_models_trainer_pycaret - INFO - MODEL PERFORMANCE SUMMARY
2025-05-17 21:34:04,052 - src.training.specific_models_trainer_pycaret - INFO - ================================================================================
2025-05-17 21:34:04,052 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_Destilled
2025-05-17 21:34:04,053 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9635
2025-05-17 21:34:04,053 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9625
2025-05-17 21:34:04,053 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9635
2025-05-17 21:34:04,053 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-05-17 21:34:04,053 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_French
2025-05-17 21:34:04,054 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9719
2025-05-17 21:34:04,054 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9717
2025-05-17 21:34:04,054 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9719
2025-05-17 21:34:04,054 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-05-17 21:34:04,054 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_Quiruelas
2025-05-17 21:34:04,055 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9607
2025-05-17 21:34:04,055 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9581
2025-05-17 21:34:04,055 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9606
2025-05-17 21:34:04,055 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-05-17 21:34:04,055 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_VdH
2025-05-17 21:34:04,056 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9466
2025-05-17 21:34:04,056 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9454
2025-05-17 21:34:04,056 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9463
2025-05-17 21:34:04,056 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-05-17 21:34:04,056 - src.training.specific_models_trainer_pycaret - INFO - 
Process completed successfully!
2025-05-17 21:34:04,057 - __main__ - INFO - 
Top 14 most important features:
2025-05-17 21:34:04,057 - __main__ - INFO - - Ca: 0.2115
2025-05-17 21:34:04,057 - __main__ - INFO - - As: 0.1162
2025-05-17 21:34:04,058 - __main__ - INFO - - Ba: 0.0722
2025-05-17 21:34:04,058 - __main__ - INFO - - V: 0.0720
2025-05-17 21:34:04,058 - __main__ - INFO - - Sr: 0.0656
2025-05-17 21:34:04,058 - __main__ - INFO - - Cr: 0.0559
2025-05-17 21:34:04,059 - __main__ - INFO - - Mo: 0.0400
2025-05-17 21:34:04,059 - __main__ - INFO - - Ta: 0.0376
2025-05-17 21:34:04,059 - __main__ - INFO - - Cu: 0.0334
2025-05-17 21:34:04,060 - __main__ - INFO - - K: 0.0318
2025-05-17 21:34:04,060 - __main__ - INFO - - Ti: 0.0313
2025-05-17 21:34:04,060 - __main__ - INFO - - S: 0.0201
2025-05-17 21:34:04,061 - __main__ - INFO - - Se: 0.0190
2025-05-17 21:34:04,061 - __main__ - INFO - - Zr: 0.0154
2025-05-17 21:34:04,062 - __main__ - INFO - Process completed successfully!
2025-05-17 21:34:04,062 - __main__ - INFO - Results saved in: my_experiments/experiment_20250517_205702
