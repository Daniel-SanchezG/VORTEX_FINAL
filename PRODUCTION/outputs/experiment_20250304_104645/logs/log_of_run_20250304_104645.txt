2025-03-04 10:46:45,950 - __main__ - INFO - Starting experiment with timestamp: 20250304_104645
2025-03-04 10:46:45,955 - __main__ - INFO - Input file: /home/dsg/VORTEX_FINAL/PRODUCTION/DATA/raw/input_data.xlsx
2025-03-04 10:46:45,957 - __main__ - INFO - Output directory: outputs/experiment_20250304_104645
2025-03-04 10:46:45,957 - __main__ - INFO - Starting data preprocessing...
2025-03-04 10:46:48,767 - src.preprocessing.data_processor - INFO - Data successfully uploaded: (1816, 67)
2025-03-04 10:46:48,773 - src.preprocessing.data_processor - INFO - Encontrados 14 IDs duplicados
2025-03-04 10:46:48,775 - src.preprocessing.data_processor - INFO - Registros únicos después de eliminar duplicados: 1802
2025-03-04 10:46:48,776 - src.preprocessing.data_processor - INFO - Eliminando 6 clases con menos de 10 casos
2025-03-04 10:46:48,780 - src.preprocessing.data_processor - INFO - División de datos - Entrenamiento: (1600, 46), Validación: (178, 46)
2025-03-04 10:46:48,885 - src.preprocessing.data_processor - INFO - Datos balanceados - Shape final: (2256, 45)
2025-03-04 10:46:51,212 - src.preprocessing.data_processor - INFO - Datos de entrenamiento guardados en outputs/experiment_20250304_104645/data/processed/training_data_20250304_104645.xlsx
2025-03-04 10:46:51,370 - src.preprocessing.data_processor - INFO - Datos de validación guardados en outputs/experiment_20250304_104645/data/processed/validation_data_20250304_104645.xlsx
2025-03-04 10:46:51,371 - __main__ - INFO - Starting model training...
2025-03-04 10:46:51,371 - src.training.model_trainer - INFO - Configuring training experiment...
2025-03-04 10:46:54,727 - src.training.model_trainer - INFO - Experiment configured successfully
2025-03-04 10:46:54,727 - src.training.model_trainer - INFO - Starting model training...
2025-03-04 10:47:08,566 - src.training.model_trainer - INFO - Optimizing hyperparameters...
2025-03-04 10:47:53,069 - src.training.model_trainer - INFO - Saving tuned model before calibration...
2025-03-04 10:47:53,381 - src.training.model_trainer - INFO - Calibrating model probabilities...
2025-03-04 10:48:37,034 - src.training.model_trainer - INFO - Saved final model directly to outputs/experiment_20250304_104645/models/final_model_direct.pkl
2025-03-04 10:48:37,035 - src.training.model_trainer - INFO - Training completed successfully
2025-03-04 10:48:37,035 - src.training.model_trainer - INFO - Evaluating model on validation data...
2025-03-04 10:48:38,384 - src.training.model_trainer - INFO - Evaluation completed
2025-03-04 10:48:38,384 - __main__ - INFO - Starting feature importance analysis...
2025-03-04 10:48:38,387 - __main__ - INFO - Retrieving tuned model for feature importance analysis...
2025-03-04 10:48:38,387 - __main__ - INFO - Running feature importance analysis...
2025-03-04 10:48:38,387 - src.analysis.feature_importance_analyzer - INFO - Starting feature importance analysis...
2025-03-04 10:48:38,387 - src.analysis.feature_importance_analyzer - INFO - Data shape: X=(2256, 44), y=(2256,)
2025-03-04 10:48:38,387 - src.analysis.feature_importance_analyzer - INFO - Output directory: outputs/experiment_20250304_104645
2025-03-04 10:48:38,387 - src.analysis.feature_importance_analyzer - INFO - Starting RFECV analysis...
2025-03-04 10:48:38,388 - src.analysis.feature_importance_analyzer - INFO - Running RFECV with 10 iterations...
2025-03-04 10:48:38,439 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 1/10
2025-03-04 10:51:14,733 - src.analysis.feature_importance_analyzer - INFO - Iteration 1 completed: selected 42 features
2025-03-04 10:51:14,733 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 2/10
2025-03-04 10:54:06,518 - src.analysis.feature_importance_analyzer - INFO - Iteration 2 completed: selected 31 features
2025-03-04 10:54:06,518 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 3/10
2025-03-04 10:57:18,176 - src.analysis.feature_importance_analyzer - INFO - Iteration 3 completed: selected 42 features
2025-03-04 10:57:18,179 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 4/10
2025-03-04 11:00:35,710 - src.analysis.feature_importance_analyzer - INFO - Iteration 4 completed: selected 28 features
2025-03-04 11:00:35,710 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 5/10
2025-03-04 11:04:08,251 - src.analysis.feature_importance_analyzer - INFO - Iteration 5 completed: selected 25 features
2025-03-04 11:04:08,252 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 6/10
2025-03-04 11:07:25,148 - src.analysis.feature_importance_analyzer - INFO - Iteration 6 completed: selected 38 features
2025-03-04 11:07:25,149 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 7/10
2025-03-04 11:10:24,645 - src.analysis.feature_importance_analyzer - INFO - Iteration 7 completed: selected 39 features
2025-03-04 11:10:24,646 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 8/10
2025-03-04 11:13:38,115 - src.analysis.feature_importance_analyzer - INFO - Iteration 8 completed: selected 35 features
2025-03-04 11:13:38,116 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 9/10
2025-03-04 11:17:26,798 - src.analysis.feature_importance_analyzer - INFO - Iteration 9 completed: selected 24 features
2025-03-04 11:17:26,798 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 10/10
2025-03-04 11:20:43,740 - src.analysis.feature_importance_analyzer - INFO - Iteration 10 completed: selected 42 features
2025-03-04 11:20:43,798 - src.analysis.feature_importance_analyzer - INFO - Creating RFECV plot...
2025-03-04 11:20:44,689 - src.analysis.feature_importance_analyzer - INFO - RFECV plot saved successfully
2025-03-04 11:20:44,691 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance plot...
2025-03-04 11:20:44,703 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance dot plot based on importance values...
2025-03-04 11:20:45,762 - src.analysis.feature_importance_analyzer - INFO - Feature importance plot saved successfully
2025-03-04 11:20:45,762 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-04 11:20:45,763 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-04 11:20:56,625 - src.analysis.feature_importance_analyzer - INFO - SHAP analysis completed successfully
2025-03-04 11:20:56,626 - src.analysis.feature_importance_analyzer - INFO - Feature importance analysis completed successfully
2025-03-04 11:20:56,627 - __main__ - INFO - Starting specific models training...
2025-03-04 11:20:56,629 - src.training.specific_models_trainer - INFO - Features pool set with 4 configurations
2025-03-04 11:20:56,629 - src.training.specific_models_trainer - INFO - Starting training of all specific models...
2025-03-04 11:20:56,632 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:20:56,632 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_Destilled
2025-03-04 11:20:56,632 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:20:56,656 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 14), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:20:56,658 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 14), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:20:56,674 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 14), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:20:56,684 - src.training.specific_models_trainer - INFO - Training model rf_Destilled...
2025-03-04 11:20:57,640 - src.training.specific_models_trainer - INFO - Calibrating model rf_Destilled...
2025-03-04 11:20:57,706 - src.training.specific_models_trainer - INFO - Evaluating model rf_Destilled...
2025-03-04 11:20:57,749 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_104645/tables/rf_Destilled_classification_report.csv
2025-03-04 11:20:57,995 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_104645/plots/rf_Destilled_confusion_matrix.png
2025-03-04 11:20:58,010 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_104645/models/rf_Destilled_calibrated.pkl
2025-03-04 11:20:58,011 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:20:58,011 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_French
2025-03-04 11:20:58,011 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:20:58,019 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 22), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:20:58,020 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 22), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:20:58,032 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 22), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:20:58,037 - src.training.specific_models_trainer - INFO - Training model rf_French...
2025-03-04 11:20:59,216 - src.training.specific_models_trainer - INFO - Calibrating model rf_French...
2025-03-04 11:20:59,246 - src.training.specific_models_trainer - INFO - Evaluating model rf_French...
2025-03-04 11:20:59,274 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_104645/tables/rf_French_classification_report.csv
2025-03-04 11:20:59,562 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_104645/plots/rf_French_confusion_matrix.png
2025-03-04 11:20:59,572 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_104645/models/rf_French_calibrated.pkl
2025-03-04 11:20:59,573 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:20:59,573 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_Quiruelas
2025-03-04 11:20:59,573 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:20:59,580 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 17), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:20:59,581 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 17), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:20:59,594 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 17), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:20:59,598 - src.training.specific_models_trainer - INFO - Training model rf_Quiruelas...
2025-03-04 11:21:00,829 - src.training.specific_models_trainer - INFO - Calibrating model rf_Quiruelas...
2025-03-04 11:21:00,855 - src.training.specific_models_trainer - INFO - Evaluating model rf_Quiruelas...
2025-03-04 11:21:00,881 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_104645/tables/rf_Quiruelas_classification_report.csv
2025-03-04 11:21:01,163 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_104645/plots/rf_Quiruelas_confusion_matrix.png
2025-03-04 11:21:01,176 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_104645/models/rf_Quiruelas_calibrated.pkl
2025-03-04 11:21:01,177 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:21:01,177 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_VdH
2025-03-04 11:21:01,177 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:21:01,181 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 19), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:21:01,182 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 19), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:21:01,193 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 19), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:21:01,198 - src.training.specific_models_trainer - INFO - Training model rf_VdH...
2025-03-04 11:21:02,473 - src.training.specific_models_trainer - INFO - Calibrating model rf_VdH...
2025-03-04 11:21:02,499 - src.training.specific_models_trainer - INFO - Evaluating model rf_VdH...
2025-03-04 11:21:02,526 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_104645/tables/rf_VdH_classification_report.csv
2025-03-04 11:21:02,805 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_104645/plots/rf_VdH_confusion_matrix.png
2025-03-04 11:21:02,819 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_104645/models/rf_VdH_calibrated.pkl
2025-03-04 11:21:02,820 - src.training.specific_models_trainer - INFO - 

================================================================================
2025-03-04 11:21:02,820 - src.training.specific_models_trainer - INFO - MODEL PERFORMANCE SUMMARY
2025-03-04 11:21:02,820 - src.training.specific_models_trainer - INFO - ================================================================================
2025-03-04 11:21:02,821 - src.training.specific_models_trainer - INFO - 
Model: rf_Destilled
2025-03-04 11:21:02,821 - src.training.specific_models_trainer - INFO - Accuracy: 0.9607
2025-03-04 11:21:02,822 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9599
2025-03-04 11:21:02,822 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9605
2025-03-04 11:21:02,822 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:21:02,822 - src.training.specific_models_trainer - INFO - 
Model: rf_French
2025-03-04 11:21:02,822 - src.training.specific_models_trainer - INFO - Accuracy: 0.9551
2025-03-04 11:21:02,823 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9542
2025-03-04 11:21:02,823 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9549
2025-03-04 11:21:02,823 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:21:02,823 - src.training.specific_models_trainer - INFO - 
Model: rf_Quiruelas
2025-03-04 11:21:02,824 - src.training.specific_models_trainer - INFO - Accuracy: 0.9494
2025-03-04 11:21:02,824 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9465
2025-03-04 11:21:02,824 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9493
2025-03-04 11:21:02,824 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:21:02,825 - src.training.specific_models_trainer - INFO - 
Model: rf_VdH
2025-03-04 11:21:02,825 - src.training.specific_models_trainer - INFO - Accuracy: 0.9157
2025-03-04 11:21:02,825 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9144
2025-03-04 11:21:02,825 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9154
2025-03-04 11:21:02,825 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:21:02,825 - src.training.specific_models_trainer - INFO - 
Process completed successfully!
2025-03-04 11:21:02,827 - __main__ - INFO - 
Top 14 most important features:
2025-03-04 11:21:02,828 - __main__ - INFO - - Ca: 0.2120
2025-03-04 11:21:02,828 - __main__ - INFO - - As: 0.1201
2025-03-04 11:21:02,828 - __main__ - INFO - - Ba: 0.0702
2025-03-04 11:21:02,829 - __main__ - INFO - - V: 0.0689
2025-03-04 11:21:02,829 - __main__ - INFO - - Sr: 0.0659
2025-03-04 11:21:02,829 - __main__ - INFO - - Cr: 0.0483
2025-03-04 11:21:02,829 - __main__ - INFO - - Mo: 0.0443
2025-03-04 11:21:02,830 - __main__ - INFO - - Ta: 0.0440
2025-03-04 11:21:02,830 - __main__ - INFO - - Cu: 0.0346
2025-03-04 11:21:02,830 - __main__ - INFO - - K: 0.0329
2025-03-04 11:21:02,831 - __main__ - INFO - - Ti: 0.0290
2025-03-04 11:21:02,831 - __main__ - INFO - - Se: 0.0212
2025-03-04 11:21:02,831 - __main__ - INFO - - S: 0.0178
2025-03-04 11:21:02,832 - __main__ - INFO - - Cl: 0.0173
2025-03-04 11:21:02,835 - __main__ - INFO - Process completed successfully!
2025-03-04 11:21:02,835 - __main__ - INFO - Results saved in: outputs/experiment_20250304_104645
