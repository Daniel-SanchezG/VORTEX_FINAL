2025-03-04 11:25:04,471 - __main__ - INFO - Starting experiment with timestamp: 20250304_112504
2025-03-04 11:25:04,471 - __main__ - INFO - Input file: /home/dsg/VORTEX_FINAL/PRODUCTION/DATA/raw/input_data.xlsx
2025-03-04 11:25:04,472 - __main__ - INFO - Output directory: outputs/experiment_20250304_112504
2025-03-04 11:25:04,472 - __main__ - INFO - Starting data preprocessing...
2025-03-04 11:25:06,392 - src.preprocessing.data_processor - INFO - Data successfully uploaded: (1816, 67)
2025-03-04 11:25:06,396 - src.preprocessing.data_processor - INFO - Encontrados 14 IDs duplicados
2025-03-04 11:25:06,397 - src.preprocessing.data_processor - INFO - Registros únicos después de eliminar duplicados: 1802
2025-03-04 11:25:06,398 - src.preprocessing.data_processor - INFO - Eliminando 6 clases con menos de 10 casos
2025-03-04 11:25:06,400 - src.preprocessing.data_processor - INFO - División de datos - Entrenamiento: (1600, 46), Validación: (178, 46)
2025-03-04 11:25:06,496 - src.preprocessing.data_processor - INFO - Datos balanceados - Shape final: (2256, 45)
2025-03-04 11:25:08,564 - src.preprocessing.data_processor - INFO - Datos de entrenamiento guardados en outputs/experiment_20250304_112504/data/processed/training_data_20250304_112504.xlsx
2025-03-04 11:25:08,715 - src.preprocessing.data_processor - INFO - Datos de validación guardados en outputs/experiment_20250304_112504/data/processed/validation_data_20250304_112504.xlsx
2025-03-04 11:25:08,715 - __main__ - INFO - Starting model training...
2025-03-04 11:25:08,715 - src.training.model_trainer - INFO - Configuring training experiment...
2025-03-04 11:25:11,716 - src.training.model_trainer - INFO - Experiment configured successfully
2025-03-04 11:25:11,716 - src.training.model_trainer - INFO - Starting model training...
2025-03-04 11:25:24,360 - src.training.model_trainer - INFO - Optimizing hyperparameters...
2025-03-04 11:26:05,973 - src.training.model_trainer - INFO - Saved tuned model directly to outputs/experiment_20250304_112504/models/tuned_model_direct.pkl
2025-03-04 11:26:05,974 - src.training.model_trainer - INFO - Saving tuned model before calibration...
2025-03-04 11:26:06,251 - src.training.model_trainer - INFO - Calibrating model probabilities...
2025-03-04 11:26:47,102 - src.training.model_trainer - INFO - Saved final model directly to outputs/experiment_20250304_112504/models/final_model_direct.pkl
2025-03-04 11:26:47,102 - src.training.model_trainer - INFO - Training completed successfully
2025-03-04 11:26:47,102 - src.training.model_trainer - INFO - Evaluating model on validation data...
2025-03-04 11:26:48,514 - src.training.model_trainer - INFO - Evaluation completed
2025-03-04 11:26:48,514 - __main__ - INFO - Starting feature importance analysis...
2025-03-04 11:26:48,516 - __main__ - INFO - Retrieving tuned model for feature importance analysis...
2025-03-04 11:26:48,516 - __main__ - INFO - Running feature importance analysis...
2025-03-04 11:26:48,516 - src.analysis.feature_importance_analyzer - INFO - Starting feature importance analysis...
2025-03-04 11:26:48,517 - src.analysis.feature_importance_analyzer - INFO - Data shape: X=(2256, 44), y=(2256,)
2025-03-04 11:26:48,517 - src.analysis.feature_importance_analyzer - INFO - Output directory: outputs/experiment_20250304_112504
2025-03-04 11:26:48,517 - src.analysis.feature_importance_analyzer - INFO - Starting RFECV analysis...
2025-03-04 11:26:48,517 - src.analysis.feature_importance_analyzer - INFO - Running RFECV with 10 iterations...
2025-03-04 11:26:48,564 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 1/10
2025-03-04 11:29:18,622 - src.analysis.feature_importance_analyzer - INFO - Iteration 1 completed: selected 42 features
2025-03-04 11:29:18,623 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 2/10
2025-03-04 11:32:02,034 - src.analysis.feature_importance_analyzer - INFO - Iteration 2 completed: selected 31 features
2025-03-04 11:32:02,035 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 3/10
2025-03-04 11:34:30,534 - src.analysis.feature_importance_analyzer - INFO - Iteration 3 completed: selected 42 features
2025-03-04 11:34:30,534 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 4/10
2025-03-04 11:37:14,140 - src.analysis.feature_importance_analyzer - INFO - Iteration 4 completed: selected 28 features
2025-03-04 11:37:14,141 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 5/10
2025-03-04 11:40:00,598 - src.analysis.feature_importance_analyzer - INFO - Iteration 5 completed: selected 25 features
2025-03-04 11:40:00,598 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 6/10
2025-03-04 11:42:33,861 - src.analysis.feature_importance_analyzer - INFO - Iteration 6 completed: selected 38 features
2025-03-04 11:42:33,861 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 7/10
2025-03-04 11:45:06,161 - src.analysis.feature_importance_analyzer - INFO - Iteration 7 completed: selected 39 features
2025-03-04 11:45:06,162 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 8/10
2025-03-04 11:47:44,576 - src.analysis.feature_importance_analyzer - INFO - Iteration 8 completed: selected 35 features
2025-03-04 11:47:44,576 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 9/10
2025-03-04 11:50:34,027 - src.analysis.feature_importance_analyzer - INFO - Iteration 9 completed: selected 24 features
2025-03-04 11:50:34,027 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 10/10
2025-03-04 11:53:06,007 - src.analysis.feature_importance_analyzer - INFO - Iteration 10 completed: selected 42 features
2025-03-04 11:53:06,016 - src.analysis.feature_importance_analyzer - INFO - Creating RFECV plot...
2025-03-04 11:53:06,611 - src.analysis.feature_importance_analyzer - INFO - RFECV plot saved successfully
2025-03-04 11:53:06,612 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance plot...
2025-03-04 11:53:06,617 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance dot plot based on importance values...
2025-03-04 11:53:07,411 - src.analysis.feature_importance_analyzer - INFO - Feature importance plot saved successfully
2025-03-04 11:53:07,411 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-04 11:53:07,411 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-04 11:53:17,867 - src.analysis.feature_importance_analyzer - INFO - SHAP analysis completed successfully
2025-03-04 11:53:17,868 - src.analysis.feature_importance_analyzer - INFO - Feature importance analysis completed successfully
2025-03-04 11:53:17,868 - __main__ - INFO - Starting specific models training...
2025-03-04 11:53:17,868 - src.training.specific_models_trainer - INFO - Features pool set with 4 configurations
2025-03-04 11:53:17,869 - src.training.specific_models_trainer - INFO - Starting training of all specific models...
2025-03-04 11:53:17,869 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:53:17,869 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_Destilled
2025-03-04 11:53:17,869 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:53:17,873 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 14), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:17,874 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 14), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:53:17,883 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 14), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:17,889 - src.training.specific_models_trainer - INFO - Training model rf_Destilled...
2025-03-04 11:53:18,838 - src.training.specific_models_trainer - INFO - Calibrating model rf_Destilled...
2025-03-04 11:53:18,862 - src.training.specific_models_trainer - INFO - Evaluating model rf_Destilled...
2025-03-04 11:53:18,888 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_112504/tables/rf_Destilled_classification_report.csv
2025-03-04 11:53:19,118 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_112504/plots/rf_Destilled_confusion_matrix.png
2025-03-04 11:53:19,133 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_112504/models/rf_Destilled_calibrated.pkl
2025-03-04 11:53:19,134 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:53:19,134 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_French
2025-03-04 11:53:19,134 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:53:19,140 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 22), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:19,141 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 22), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:53:19,153 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 22), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:19,157 - src.training.specific_models_trainer - INFO - Training model rf_French...
2025-03-04 11:53:20,324 - src.training.specific_models_trainer - INFO - Calibrating model rf_French...
2025-03-04 11:53:20,350 - src.training.specific_models_trainer - INFO - Evaluating model rf_French...
2025-03-04 11:53:20,375 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_112504/tables/rf_French_classification_report.csv
2025-03-04 11:53:20,650 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_112504/plots/rf_French_confusion_matrix.png
2025-03-04 11:53:20,658 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_112504/models/rf_French_calibrated.pkl
2025-03-04 11:53:20,659 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:53:20,659 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_Quiruelas
2025-03-04 11:53:20,659 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:53:20,663 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 17), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:20,664 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 17), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:53:20,673 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 17), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:20,678 - src.training.specific_models_trainer - INFO - Training model rf_Quiruelas...
2025-03-04 11:53:21,868 - src.training.specific_models_trainer - INFO - Calibrating model rf_Quiruelas...
2025-03-04 11:53:21,892 - src.training.specific_models_trainer - INFO - Evaluating model rf_Quiruelas...
2025-03-04 11:53:21,918 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_112504/tables/rf_Quiruelas_classification_report.csv
2025-03-04 11:53:22,202 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_112504/plots/rf_Quiruelas_confusion_matrix.png
2025-03-04 11:53:22,211 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_112504/models/rf_Quiruelas_calibrated.pkl
2025-03-04 11:53:22,212 - src.training.specific_models_trainer - INFO - 
==================================================
2025-03-04 11:53:22,212 - src.training.specific_models_trainer - INFO - Processing configuration: trainning_features_VdH
2025-03-04 11:53:22,212 - src.training.specific_models_trainer - INFO - ==================================================
2025-03-04 11:53:22,217 - src.training.specific_models_trainer - INFO - Training data shape: (2256, 19), class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:22,218 - src.training.specific_models_trainer - INFO - Validation data shape: (178, 19), class distribution: Site
CT      76
PDLC    54
PCM     48
Name: count, dtype: int64
2025-03-04 11:53:22,227 - src.training.specific_models_trainer - INFO - Balanced data shape: (2256, 19), distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-04 11:53:22,232 - src.training.specific_models_trainer - INFO - Training model rf_VdH...
2025-03-04 11:53:23,507 - src.training.specific_models_trainer - INFO - Calibrating model rf_VdH...
2025-03-04 11:53:23,534 - src.training.specific_models_trainer - INFO - Evaluating model rf_VdH...
2025-03-04 11:53:23,560 - src.training.specific_models_trainer - INFO - Classification report saved in: outputs/experiment_20250304_112504/tables/rf_VdH_classification_report.csv
2025-03-04 11:53:23,779 - src.training.specific_models_trainer - INFO - Confusion matrix saved in: outputs/experiment_20250304_112504/plots/rf_VdH_confusion_matrix.png
2025-03-04 11:53:23,788 - src.training.specific_models_trainer - INFO - Model saved in: outputs/experiment_20250304_112504/models/rf_VdH_calibrated.pkl
2025-03-04 11:53:23,788 - src.training.specific_models_trainer - INFO - 

================================================================================
2025-03-04 11:53:23,788 - src.training.specific_models_trainer - INFO - MODEL PERFORMANCE SUMMARY
2025-03-04 11:53:23,789 - src.training.specific_models_trainer - INFO - ================================================================================
2025-03-04 11:53:23,789 - src.training.specific_models_trainer - INFO - 
Model: rf_Destilled
2025-03-04 11:53:23,789 - src.training.specific_models_trainer - INFO - Accuracy: 0.9607
2025-03-04 11:53:23,789 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9599
2025-03-04 11:53:23,789 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9605
2025-03-04 11:53:23,790 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:53:23,790 - src.training.specific_models_trainer - INFO - 
Model: rf_French
2025-03-04 11:53:23,790 - src.training.specific_models_trainer - INFO - Accuracy: 0.9551
2025-03-04 11:53:23,790 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9542
2025-03-04 11:53:23,791 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9549
2025-03-04 11:53:23,791 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:53:23,791 - src.training.specific_models_trainer - INFO - 
Model: rf_Quiruelas
2025-03-04 11:53:23,791 - src.training.specific_models_trainer - INFO - Accuracy: 0.9494
2025-03-04 11:53:23,791 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9465
2025-03-04 11:53:23,792 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9493
2025-03-04 11:53:23,792 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:53:23,792 - src.training.specific_models_trainer - INFO - 
Model: rf_VdH
2025-03-04 11:53:23,792 - src.training.specific_models_trainer - INFO - Accuracy: 0.9157
2025-03-04 11:53:23,792 - src.training.specific_models_trainer - INFO - F1-score (macro avg): 0.9144
2025-03-04 11:53:23,793 - src.training.specific_models_trainer - INFO - F1-score (weighted avg): 0.9154
2025-03-04 11:53:23,793 - src.training.specific_models_trainer - INFO - --------------------------------------------------
2025-03-04 11:53:23,793 - src.training.specific_models_trainer - INFO - 
Process completed successfully!
2025-03-04 11:53:23,794 - __main__ - INFO - 
Top 14 most important features:
2025-03-04 11:53:23,795 - __main__ - INFO - - Ca: 0.2120
2025-03-04 11:53:23,795 - __main__ - INFO - - As: 0.1201
2025-03-04 11:53:23,795 - __main__ - INFO - - Ba: 0.0702
2025-03-04 11:53:23,796 - __main__ - INFO - - V: 0.0689
2025-03-04 11:53:23,796 - __main__ - INFO - - Sr: 0.0659
2025-03-04 11:53:23,796 - __main__ - INFO - - Cr: 0.0483
2025-03-04 11:53:23,797 - __main__ - INFO - - Mo: 0.0443
2025-03-04 11:53:23,797 - __main__ - INFO - - Ta: 0.0440
2025-03-04 11:53:23,797 - __main__ - INFO - - Cu: 0.0346
2025-03-04 11:53:23,797 - __main__ - INFO - - K: 0.0329
2025-03-04 11:53:23,798 - __main__ - INFO - - Ti: 0.0290
2025-03-04 11:53:23,798 - __main__ - INFO - - Se: 0.0212
2025-03-04 11:53:23,798 - __main__ - INFO - - S: 0.0178
2025-03-04 11:53:23,799 - __main__ - INFO - - Cl: 0.0173
2025-03-04 11:53:23,802 - __main__ - INFO - Process completed successfully!
2025-03-04 11:53:23,802 - __main__ - INFO - Results saved in: outputs/experiment_20250304_112504
