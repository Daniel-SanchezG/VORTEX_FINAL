2025-03-07 15:42:49,304 - __main__ - INFO - Starting experiment with timestamp: 20250307_154249
2025-03-07 15:42:49,304 - __main__ - INFO - Input file: /home/dsg/VORTEX_FINAL/PRODUCTION/DATA/raw/input_data.xlsx
2025-03-07 15:42:49,304 - __main__ - INFO - Output directory: outputs/experiment_20250307_154249
2025-03-07 15:42:49,304 - __main__ - INFO - Full analysis: Yes
2025-03-07 15:42:49,304 - __main__ - INFO - Starting data preprocessing...
2025-03-07 15:42:52,700 - src.preprocessing.data_processor - INFO - Data successfully uploaded: (1816, 67)
2025-03-07 15:42:52,715 - src.preprocessing.data_processor - INFO - Found 14 duplicate IDs
2025-03-07 15:42:52,716 - src.preprocessing.data_processor - INFO - Unique records after deleting duplicates: 1802
2025-03-07 15:42:52,719 - src.preprocessing.data_processor - INFO - Deleting 6 classes with less than 10 cases
2025-03-07 15:42:52,724 - src.preprocessing.data_processor - INFO - Data split - Training: (1600, 46), Validation: (178, 46)
2025-03-07 15:42:52,940 - src.preprocessing.data_processor - INFO - Balanced data - Final shape: (2256, 45)
2025-03-07 15:42:55,128 - src.preprocessing.data_processor - INFO - Training data saved in outputs/experiment_20250307_154249/data/processed/training_data_20250307_154249.xlsx
2025-03-07 15:42:55,290 - src.preprocessing.data_processor - INFO - Validation data saved in outputs/experiment_20250307_154249/data/processed/validation_data_20250307_154249.xlsx
2025-03-07 15:42:55,290 - __main__ - INFO - Starting model training...
2025-03-07 15:42:55,291 - src.training.model_trainer - INFO - Configuring training experiment...
2025-03-07 15:42:58,584 - src.training.model_trainer - INFO - Experiment configured successfully
2025-03-07 15:42:58,584 - src.training.model_trainer - INFO - Starting model training...
2025-03-07 15:43:12,657 - src.training.model_trainer - INFO - Optimizing hyperparameters...
2025-03-07 15:44:03,903 - src.training.model_trainer - INFO - Saved tuned model directly to outputs/experiment_20250307_154249/models/tuned_model_direct.pkl
2025-03-07 15:44:03,903 - src.training.model_trainer - INFO - Saving tuned model before calibration...
2025-03-07 15:44:04,182 - src.training.model_trainer - INFO - Calibrating model probabilities...
2025-03-07 15:44:44,577 - src.training.model_trainer - INFO - Saved final model directly to outputs/experiment_20250307_154249/models/final_model_direct.pkl
2025-03-07 15:44:44,577 - src.training.model_trainer - INFO - Training completed successfully
2025-03-07 15:44:44,577 - src.training.model_trainer - INFO - Evaluating model on validation data...
2025-03-07 15:44:45,938 - src.training.model_trainer - INFO - Evaluation completed
2025-03-07 15:44:45,938 - __main__ - INFO - Starting feature importance analysis...
2025-03-07 15:44:45,940 - __main__ - INFO - Retrieving tuned model for feature importance analysis...
2025-03-07 15:44:45,940 - __main__ - INFO - Running feature importance analysis...
2025-03-07 15:44:45,940 - src.analysis.feature_importance_analyzer - INFO - Starting feature importance analysis...
2025-03-07 15:44:45,940 - src.analysis.feature_importance_analyzer - INFO - Data shape: X=(2256, 44), y=(2256,)
2025-03-07 15:44:45,941 - src.analysis.feature_importance_analyzer - INFO - Output directory: outputs/experiment_20250307_154249
2025-03-07 15:44:45,941 - src.analysis.feature_importance_analyzer - INFO - Starting RFECV analysis...
2025-03-07 15:44:45,941 - src.analysis.feature_importance_analyzer - INFO - Running RFECV with 10 iterations...
2025-03-07 15:44:46,009 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 1/10
2025-03-07 15:47:19,654 - src.analysis.feature_importance_analyzer - INFO - Iteration 1 completed: selected 42 features
2025-03-07 15:47:19,655 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 2/10
2025-03-07 15:50:00,316 - src.analysis.feature_importance_analyzer - INFO - Iteration 2 completed: selected 31 features
2025-03-07 15:50:00,317 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 3/10
2025-03-07 15:52:33,133 - src.analysis.feature_importance_analyzer - INFO - Iteration 3 completed: selected 42 features
2025-03-07 15:52:33,134 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 4/10
2025-03-07 15:55:51,176 - src.analysis.feature_importance_analyzer - INFO - Iteration 4 completed: selected 28 features
2025-03-07 15:55:51,178 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 5/10
2025-03-07 15:59:00,559 - src.analysis.feature_importance_analyzer - INFO - Iteration 5 completed: selected 25 features
2025-03-07 15:59:00,560 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 6/10
2025-03-07 16:01:35,896 - src.analysis.feature_importance_analyzer - INFO - Iteration 6 completed: selected 38 features
2025-03-07 16:01:35,897 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 7/10
2025-03-07 16:04:13,427 - src.analysis.feature_importance_analyzer - INFO - Iteration 7 completed: selected 39 features
2025-03-07 16:04:13,427 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 8/10
2025-03-07 16:07:18,031 - src.analysis.feature_importance_analyzer - INFO - Iteration 8 completed: selected 35 features
2025-03-07 16:07:18,033 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 9/10
2025-03-07 16:10:18,576 - src.analysis.feature_importance_analyzer - INFO - Iteration 9 completed: selected 24 features
2025-03-07 16:10:18,577 - src.analysis.feature_importance_analyzer - INFO - RFECV iteration 10/10
2025-03-07 16:12:54,961 - src.analysis.feature_importance_analyzer - INFO - Iteration 10 completed: selected 42 features
2025-03-07 16:12:55,012 - src.analysis.feature_importance_analyzer - INFO - Creating RFECV plot...
2025-03-07 16:12:56,032 - src.analysis.feature_importance_analyzer - INFO - RFECV plot saved successfully
2025-03-07 16:12:56,033 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance plot...
2025-03-07 16:12:56,047 - src.analysis.feature_importance_analyzer - INFO - Creating feature importance dot plot based on importance values...
2025-03-07 16:12:57,022 - src.analysis.feature_importance_analyzer - INFO - Feature importance plot saved successfully
2025-03-07 16:12:57,023 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-07 16:12:57,023 - src.analysis.feature_importance_analyzer - INFO - Running SHAP analysis...
2025-03-07 16:13:07,915 - src.analysis.feature_importance_analyzer - INFO - SHAP analysis completed successfully
2025-03-07 16:13:07,916 - src.analysis.feature_importance_analyzer - INFO - Feature importance analysis completed successfully
2025-03-07 16:13:07,918 - __main__ - INFO - Starting specific models training...
2025-03-07 16:13:07,920 - src.training.specific_models_trainer_pycaret - INFO - Features pool set with 4 configurations
2025-03-07 16:13:07,920 - src.training.specific_models_trainer_pycaret - INFO - Starting training of all specific models...
2025-03-07 16:13:07,921 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-07 16:13:07,921 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_Destilled
2025-03-07 16:13:07,921 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-07 16:13:07,942 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 15)
2025-03-07 16:13:07,947 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-07 16:13:07,947 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 15)
2025-03-07 16:13:07,947 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_Destilled...
2025-03-07 16:13:07,948 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-07 16:13:09,610 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-07 16:13:20,477 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_Destilled...
2025-03-07 16:14:04,142 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_Destilled...
2025-03-07 16:14:42,979 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_Destilled...
2025-03-07 16:14:49,081 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250307_154249/models/rf_Destilled
2025-03-07 16:14:49,081 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_Destilled on validation data...
2025-03-07 16:14:50,457 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250307_154249/tables/rf_Destilled_classification_report.csv
2025-03-07 16:14:50,811 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250307_154249/plots/rf_Destilled_confusion_matrix.png
2025-03-07 16:14:50,817 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250307_154249/tables/rf_Destilled_predictions.csv
2025-03-07 16:14:50,818 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-07 16:14:50,818 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_French
2025-03-07 16:14:50,818 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-07 16:14:50,827 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 23)
2025-03-07 16:14:50,829 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-07 16:14:50,829 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 23)
2025-03-07 16:14:50,829 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_French...
2025-03-07 16:14:50,829 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-07 16:14:51,984 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-07 16:15:00,700 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_French...
2025-03-07 16:15:58,593 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_French...
2025-03-07 16:16:38,700 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_French...
2025-03-07 16:16:46,368 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250307_154249/models/rf_French
2025-03-07 16:16:46,369 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_French on validation data...
2025-03-07 16:16:47,557 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250307_154249/tables/rf_French_classification_report.csv
2025-03-07 16:16:48,016 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250307_154249/plots/rf_French_confusion_matrix.png
2025-03-07 16:16:48,030 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250307_154249/tables/rf_French_predictions.csv
2025-03-07 16:16:48,030 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-07 16:16:48,031 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_Quiruelas
2025-03-07 16:16:48,031 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-07 16:16:48,035 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 18)
2025-03-07 16:16:48,039 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-07 16:16:48,040 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 18)
2025-03-07 16:16:48,040 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_Quiruelas...
2025-03-07 16:16:48,040 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-07 16:16:49,214 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-07 16:16:59,420 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_Quiruelas...
2025-03-07 16:17:49,922 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_Quiruelas...
2025-03-07 16:18:20,871 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_Quiruelas...
2025-03-07 16:18:26,954 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250307_154249/models/rf_Quiruelas
2025-03-07 16:18:26,954 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_Quiruelas on validation data...
2025-03-07 16:18:28,005 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250307_154249/tables/rf_Quiruelas_classification_report.csv
2025-03-07 16:18:28,303 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250307_154249/plots/rf_Quiruelas_confusion_matrix.png
2025-03-07 16:18:28,311 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250307_154249/tables/rf_Quiruelas_predictions.csv
2025-03-07 16:18:28,311 - src.training.specific_models_trainer_pycaret - INFO - 
==================================================
2025-03-07 16:18:28,311 - src.training.specific_models_trainer_pycaret - INFO - Processing configuration: trainning_features_VdH
2025-03-07 16:18:28,312 - src.training.specific_models_trainer_pycaret - INFO - ==================================================
2025-03-07 16:18:28,315 - src.training.specific_models_trainer_pycaret - INFO - Training data shape: (2256, 20)
2025-03-07 16:18:28,317 - src.training.specific_models_trainer_pycaret - INFO - Class distribution: Site
PDLC    752
CT      752
PCM     752
Name: count, dtype: int64
2025-03-07 16:18:28,317 - src.training.specific_models_trainer_pycaret - INFO - Validation data shape: (178, 20)
2025-03-07 16:18:28,317 - src.training.specific_models_trainer_pycaret - INFO - Training model rf_VdH...
2025-03-07 16:18:28,318 - src.training.specific_models_trainer_pycaret - INFO - Setting up PyCaret experiment...
2025-03-07 16:18:29,438 - src.training.specific_models_trainer_pycaret - INFO - Creating base Random Forest model...
2025-03-07 16:18:38,012 - src.training.specific_models_trainer_pycaret - INFO - Tuning model rf_VdH...
2025-03-07 16:19:29,181 - src.training.specific_models_trainer_pycaret - INFO - Calibrating model rf_VdH...
2025-03-07 16:20:01,793 - src.training.specific_models_trainer_pycaret - INFO - Finalizing model rf_VdH...
2025-03-07 16:20:07,429 - src.training.specific_models_trainer_pycaret - INFO - Model saved at: outputs/experiment_20250307_154249/models/rf_VdH
2025-03-07 16:20:07,429 - src.training.specific_models_trainer_pycaret - INFO - Evaluating model rf_VdH on validation data...
2025-03-07 16:20:08,542 - src.training.specific_models_trainer_pycaret - INFO - Classification report saved in: outputs/experiment_20250307_154249/tables/rf_VdH_classification_report.csv
2025-03-07 16:20:08,862 - src.training.specific_models_trainer_pycaret - INFO - Confusion matrix saved in: outputs/experiment_20250307_154249/plots/rf_VdH_confusion_matrix.png
2025-03-07 16:20:08,866 - src.training.specific_models_trainer_pycaret - INFO - Predictions saved in: outputs/experiment_20250307_154249/tables/rf_VdH_predictions.csv
2025-03-07 16:20:08,867 - src.training.specific_models_trainer_pycaret - INFO - 

================================================================================
2025-03-07 16:20:08,867 - src.training.specific_models_trainer_pycaret - INFO - MODEL PERFORMANCE SUMMARY
2025-03-07 16:20:08,867 - src.training.specific_models_trainer_pycaret - INFO - ================================================================================
2025-03-07 16:20:08,867 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_Destilled
2025-03-07 16:20:08,868 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9494
2025-03-07 16:20:08,868 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9478
2025-03-07 16:20:08,868 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9493
2025-03-07 16:20:08,868 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-07 16:20:08,868 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_French
2025-03-07 16:20:08,869 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9607
2025-03-07 16:20:08,869 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9583
2025-03-07 16:20:08,869 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9606
2025-03-07 16:20:08,869 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-07 16:20:08,869 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_Quiruelas
2025-03-07 16:20:08,870 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9494
2025-03-07 16:20:08,870 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9454
2025-03-07 16:20:08,870 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9495
2025-03-07 16:20:08,871 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-07 16:20:08,871 - src.training.specific_models_trainer_pycaret - INFO - 
Model: rf_VdH
2025-03-07 16:20:08,871 - src.training.specific_models_trainer_pycaret - INFO - Accuracy: 0.9101
2025-03-07 16:20:08,872 - src.training.specific_models_trainer_pycaret - INFO - F1-score (macro avg): 0.9084
2025-03-07 16:20:08,872 - src.training.specific_models_trainer_pycaret - INFO - F1-score (weighted avg): 0.9098
2025-03-07 16:20:08,872 - src.training.specific_models_trainer_pycaret - INFO - --------------------------------------------------
2025-03-07 16:20:08,872 - src.training.specific_models_trainer_pycaret - INFO - 
Process completed successfully!
2025-03-07 16:20:08,872 - __main__ - INFO - 
Top 14 most important features:
2025-03-07 16:20:08,873 - __main__ - INFO - - Ca: 0.2120
2025-03-07 16:20:08,874 - __main__ - INFO - - As: 0.1201
2025-03-07 16:20:08,875 - __main__ - INFO - - Ba: 0.0702
2025-03-07 16:20:08,875 - __main__ - INFO - - V: 0.0689
2025-03-07 16:20:08,875 - __main__ - INFO - - Sr: 0.0659
2025-03-07 16:20:08,876 - __main__ - INFO - - Cr: 0.0483
2025-03-07 16:20:08,876 - __main__ - INFO - - Mo: 0.0443
2025-03-07 16:20:08,876 - __main__ - INFO - - Ta: 0.0440
2025-03-07 16:20:08,877 - __main__ - INFO - - Cu: 0.0346
2025-03-07 16:20:08,877 - __main__ - INFO - - K: 0.0329
2025-03-07 16:20:08,877 - __main__ - INFO - - Ti: 0.0290
2025-03-07 16:20:08,878 - __main__ - INFO - - Se: 0.0212
2025-03-07 16:20:08,878 - __main__ - INFO - - S: 0.0178
2025-03-07 16:20:08,879 - __main__ - INFO - - Cl: 0.0173
2025-03-07 16:20:08,880 - __main__ - INFO - Process completed successfully!
2025-03-07 16:20:08,880 - __main__ - INFO - Results saved in: outputs/experiment_20250307_154249
